# Инструкция по установке
## 1. Выбор типа подключения
**Проект LedStripController предоставляет два способа управления:**
* По проводу, используя **[клиент для десктопных платформ](https://github.com/Guha5277/LedStripController/tree/master/WS2812B_Controller)**
* Беспроводное соединение Bluetooth с помощью **[Android-клиента](https://github.com/Guha5277/LedStripController/tree/master/WS2812B_Android)**

**Важно! Невозможно использовать эти два способа одновременно!**

Все дело в том, что обычно, Bluetooth-модули (такие как SPP-C) используют UART для обмена данными с микроконтроллером. 
И по этому, вы либо занимаете аппаратный UART МК обменом данными с ПК по проводу, либо Bluetooth-модулем. По этой-же причине, у вас не получится прошить МК в случае, если в вашей схеме уже подключен Bluetooth-модуль (т.к. он будет занимать UART) - используйте макетную плату или перемычики/переключатели, чтобы отключать BT-модуль во время прошивки.
*(Предположу, что на платах, с двумя аппаратными UART такой проблемы нет)*

## 2. Настройка микроконтроллера (серверной части) [Nodemcu](https://github.com/Guha5277/LedStripController/tree/master/WS2812B_Remote_Nodemcu) [Arduino](https://github.com/Guha5277/LedStripController/tree/master/WS2812B_Remote_Arduino)
### 2.1 Переопределите константы в файле WS2812B_Remote_*(Arduino/Nodemcu)*
* **LED_COUNT** - замените значение "27" на значение, соответствующее количеству светодиодов в ленте
* **LED_DT** - здесь пропишите цифровой пин, к которому подключена лента
### 2.2 Задайте скорость подключения по UART (BaudRate)
~~~
Строка Serial.begin(115200)
~~~

Установите скорость, на которой работает ваш BT модуль по умолчанию (У SPP-C это 9600, например), либо настройте BT-модуль на желаемую скорость и не забудье указать изменения в этой строке.

В случае, если вы планируете управлять лентой с помощью десктопного клиента, то скорость может-быть произвольной (единственное, что её нужно-будет запомнить и указать в качестве параметра, при подключении).

### 2.3 Иницализируйте ПЗУ (EEPROM) микроконтроллера начальными значениями

Некоторые значения - такие как стартовый режим, общий уровень яркости, состояние авторежима или автосохранения, а также, список с активированными/деактивированными эффектами МК хранит в ПЗУ. Когда пользователь вносит изменения и сохраняет их, данные в ПЗУ обновляются. При старте/перезагрузке системы, эти данные подгружаются из ПЗУ и используются в ходе работы скетча. Таким образом, достигается возможность настройки работы МК под себя. Чтобы инициализировать значения, в блоке **setup() нужно проделать следующее:**

**2.3.1** Закомментируйте функцию loadSettings()

**2.3.2** В скетче для **Nodemcu** раскоментируйте следующие строки:
~~~
EEPROM.begin(64);
EEPROM.write(0, 100);
EEPROM.write(1, 3);
EEPROM.write(2, 1);

int index = 0;
    for(int z = 3; z < 52; z++){
        EEPROM.write(z, ledModes[index]);
        index++;
      }
      
EEPROM.write(52, 10); 
EEPROM.write(53, 0);
EEPROM.write(54, 0);
EEPROM.write(55, 5);
  EEPROM.commit();
  EEPROM.end();
~~~

**2.3.2** В скетче для **Arduino** раскоментируйте следующие строки:

~~~
EEPROM.update(0, 100);
EEPROM.update(1, 3); 
EEPROM.update(2, 1);

int index = 0;
for(int z = 3; z < 52; z++){
  EEPROM.update(z, ledModes[index]);
  index++;
}  

EEPROM.update(52, 10);
EEPROM.update(53, 0);
EEPROM.update(54, 0);
EEPROM.update(55, 5);
~~~

**2.3.3** Залейте скетч

**2.3.4** Запустите МК, подождите пару-тройку секунд

**2.3.5** Верните изменения обратно в скетче (раскомментируйте функцию loadSettings(), закомментируйте строки из пункта 2.3.2

**2.3.6** Заново залейте скетч. Ваш МК готов к работе!

## 3. Установка клиента

**Если вы хотите использовать десктопный клиент:**
* Убедитесь, что у вас установлен JRE (не ниже версии 8.0). Если он не установлен, то скачайте и установите [отсюда](https://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html) 
* Скачайте исполняемый JAR файл WSCON1.0.jar из папки [Builds](https://github.com/Guha5277/LedStripController/tree/master/Builds)
* Подключите МК к компьютеру, убедитесь, что необходимые драйверы установлены и устройство определяется как COM-устройство.
* Запустите программу, в верхней части выберите COM-порт и скорость подключения (которую вы установили в пункте 2.2), нажмите кнопку "подключиться".

**Если вы хотите использовать Android-клиент:**
* Скачайте установочный apk файл для Android - WSCON1.0.apk из папки [Builds](https://github.com/Guha5277/LedStripController/tree/master/Builds)
* Установите клиент на свой смартфон
* Включите Bluetooth, установите сопряжение с Bluetooth-модулем, который связан с МК.
* Запустите программу, на стартовом экране, из списка, выберите необходимое устройство - произойдёт установка соединения.
